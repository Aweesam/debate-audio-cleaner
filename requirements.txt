################################################################################
# Extra index for CUDA 12.1 wheels (works on Win‑GPU + Linux containers)
################################################################################
--extra-index-url https://download.pytorch.org/whl/cu121

################################################################################
# Core scientific
################################################################################
numpy==1.26.4
scipy>=1.10
soundfile>=0.12

################################################################################
# GPU PyTorch 2.2.2  +  CUDA 12.1 wheels
################################################################################
torch==2.2.2+cu121
torchaudio==2.2.2+cu121

################################################################################
# Lightning (≤2.1 to avoid torch._dynamo ‘skip_code’ mismatch)
################################################################################
lightning<2.2

################################################################################
# Enhancement / separation
################################################################################
speechbrain>=1.1.1
demucs==4.0.1          # multi‑speaker denoiser

################################################################################
# Diarisation & Hugging Face
################################################################################
pyannote.audio>=3.1.1
huggingface_hub>=0.23
charset_normalizer>=3.3

################################################################################
# YouTube audio extractor
################################################################################
yt-dlp>=2024.4
